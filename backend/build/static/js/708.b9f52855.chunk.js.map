{"version":3,"file":"static/js/708.b9f52855.chunk.js","mappings":"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","sources":["webpack://jet-fighters-online-2.0/./src/components/PageNonexistent.module.scss?4a1d","components/PageNonexistent.js","routes/game/hooks/useGameWsEvents.js","hooks/useEventListener.js","routes/game/hooks/useKeyEvents.js","routes/game/utils/canvas.js","webpack://jet-fighters-online-2.0/./src/routes/game/components/Game.module.scss?e7c3","routes/game/components/Game.js","webpack://jet-fighters-online-2.0/./src/routes/game/components/Header.module.scss?b85b","routes/game/components/Header.js","webpack://jet-fighters-online-2.0/./src/routes/game/components/Player.module.scss?3bdf","routes/game/components/Player.js","webpack://jet-fighters-online-2.0/./src/routes/game/components/TablePlayers.module.scss?f062","routes/game/components/TablePlayers.js","webpack://jet-fighters-online-2.0/./src/routes/game/components/Countdown.module.scss?07b6","routes/game/components/Countdown.js","webpack://jet-fighters-online-2.0/./src/routes/game/components/GameOver.module.scss?a6d8","routes/game/components/GameOver.js","webpack://jet-fighters-online-2.0/./src/routes/game/components/Overlay.module.scss?1064","routes/game/components/Overlay.js","webpack://jet-fighters-online-2.0/./src/routes/game/PageGame.module.scss?5bdc","routes/game/PageGame.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"wrapper\":\"PageNonexistent_wrapper__C-izW\",\"link\":\"PageNonexistent_link__hq7XP\",\"text\":\"PageNonexistent_text__7hUu3\"};","import { Link } from 'react-router-dom';\r\n\r\n// styles\r\nimport styles from './PageNonexistent.module.scss';\r\n\r\nconst PageNonexistent = () => (\r\n  <main className={styles.wrapper}>\r\n    <div className={styles.text}>404 no page here</div>\r\n\r\n    <Link className={styles.link} to=\"/\">\r\n      home\r\n    </Link>\r\n  </main>\r\n);\r\n\r\nexport default PageNonexistent;\r\n","/* eslint-disable no-use-before-define */\r\nimport { useEffect } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\n\r\n// shared hooks\r\nimport { useContextGlobal } from '../../../providers/ProviderGlobal';\r\nimport {\r\n  useContextLobby,\r\n  valueDefaultProviderLobby,\r\n} from '../../../providers/ProviderLobby';\r\nimport { useContextWebsocket } from '../../../providers/ProviderWebsocket';\r\n\r\nconst useGameWsEvents = () => {\r\n  const { state: stateGameInitial } = useLocation();\r\n  const [global, setGlobal] = useContextGlobal();\r\n  const [lobby, setLobby] = useContextLobby();\r\n  const { message, resetMessage } = useContextWebsocket();\r\n  const navigate = useNavigate();\r\n\r\n  const { stateApp } = global;\r\n  const { event } = message;\r\n  const { stateGame } = message;\r\n\r\n  const stateGameValid = stateGame || stateGameInitial || stateGameDefault;\r\n  const isStateAppCountdown = stateApp === 'countdown';\r\n  const isStateAppGame = stateApp === 'game';\r\n\r\n  useEffect(() => {\r\n    if (isStateAppGame && event === 'updateGame') {\r\n      console.log('EVENT: updateGame');\r\n      // stateGameCurrent.current = stateGameReceived;\r\n    }\r\n\r\n    // received by the owner when the joiner quit the lobby.\r\n    if ((isStateAppGame || isStateAppCountdown) && event === 'quitJoiner') {\r\n      console.log('EVENT: quitJoiner');\r\n      setGlobal((prev) => ({\r\n        ...prev,\r\n        stateApp: 'lobby',\r\n        msgPopup: `${lobby.nameJoiner} has quit/disconnected.`,\r\n      }));\r\n      setLobby((prev) => ({\r\n        ...prev,\r\n        nameJoiner: 'Empty...',\r\n        isConnectedJoiner: false,\r\n        isReadyJoiner: false,\r\n      }));\r\n      resetMessage();\r\n      navigate('/lobby');\r\n    }\r\n\r\n    // received by the joiner when the owner quit the lobby\r\n    if ((isStateAppGame || isStateAppCountdown) && event === 'quitOwner') {\r\n      console.log('EVENT: quitOwner');\r\n      setGlobal((prev) => ({\r\n        ...prev,\r\n        stateApp: 'preLobby',\r\n        msgPopup: `${lobby.nameOwner} has quit/disconnected.`,\r\n      }));\r\n      setLobby({ ...valueDefaultProviderLobby });\r\n      resetMessage();\r\n      navigate('/');\r\n    }\r\n\r\n    if (isStateAppGame && event === 'gameOver') {\r\n      console.log('EVENT: gameOver');\r\n\r\n      const { winner, winsOwner, winsJoiner } = message;\r\n      console.log('Winner: ', winner);\r\n\r\n      setGlobal((prev) => ({ ...prev, stateApp: 'gameOver', winner }));\r\n      setLobby((prev) => ({\r\n        ...prev,\r\n        winsOwner,\r\n        winsJoiner,\r\n        isReadyOwner: false,\r\n        isReadyJoiner: false,\r\n      }));\r\n      // stateGameCurrent.current = stateGameReceived;\r\n    }\r\n  }, [message]);\r\n\r\n  return stateGameValid;\r\n};\r\n\r\nconst stateGameDefault = {\r\n  joiner: {\r\n    name: '_____ ',\r\n    score: 0,\r\n  },\r\n  owner: {\r\n    name: '_____ ',\r\n    score: 0,\r\n  },\r\n  settings: {\r\n    scoreMax: '0',\r\n    widthMap: 600,\r\n    heightMap: 300,\r\n  },\r\n};\r\n\r\nexport default useGameWsEvents;\r\n","import { useRef, useEffect } from 'react';\r\n\r\n/**\r\n * Puts an event listener to an element.\r\n * @param {string} eventName event name.\r\n * @param {function} handler event handler function.\r\n * @param {Object} [element=window] default = window, optional object to put the eventListener on.\r\n *\r\n */\r\nconst useEventListener = (eventName, handler, element = window) => {\r\n  // stores the handler\r\n  const savedHandler = useRef();\r\n\r\n  // Update ref.current value if handler changes.\r\n  // This allows our effect below to always get latest handler\r\n  // without us needing to pass it in effect deps array\r\n  // and potentially cause effect to re-run every render.\r\n  useEffect(() => {\r\n    console.log('effect runs');\r\n    savedHandler.current = handler;\r\n  }, [handler]);\r\n\r\n  useEffect(() => {\r\n    const isSuported = element && element.addEventListener;\r\n    if (!isSuported) {\r\n      console.log(`Element doesn't support addEventListener`);\r\n      return;\r\n    }\r\n\r\n    // Create event listener that calls handler function stored in ref\r\n    // don't know why exactly it is needed ...\r\n    // probably to not refference the same function but to call it\r\n    const eventListener = (event) => savedHandler.current(event);\r\n\r\n    console.log(`${eventName} event added`);\r\n    element.addEventListener(eventName, eventListener);\r\n\r\n    return () => {\r\n      element.removeEventListener(eventName, eventListener);\r\n      console.log(`${eventName} event removed`);\r\n    };\r\n  }, [eventName, element]);\r\n};\r\n\r\nexport default useEventListener;\r\n","import { useCallback } from 'react';\r\n\r\n// shared hooks\r\nimport { useContextGlobal } from '../../../providers/ProviderGlobal';\r\nimport { useContextWebsocket } from '../../../providers/ProviderWebsocket';\r\nimport useEventListener from '../../../hooks/useEventListener';\r\n\r\nconst useKeyEvents = () => {\r\n  const [global] = useContextGlobal();\r\n  const { sendMessage } = useContextWebsocket();\r\n\r\n  const { stateApp, isOwnerLobby } = global;\r\n\r\n  const isStateAppGame = stateApp === 'game';\r\n\r\n  const handleKeyDown = useCallback(\r\n    (e) => {\r\n      if (isStateAppGame) {\r\n        e.preventDefault();\r\n        if (e.repeat) return;\r\n\r\n        const response = {\r\n          event: 'input',\r\n          isOwnerLobby,\r\n        };\r\n\r\n        switch (e.key) {\r\n          case 'ArrowRight':\r\n            sendMessage({ ...response, isPressedRight: true });\r\n            return;\r\n\r\n          case 'ArrowLeft':\r\n            sendMessage({ ...response, isPressedLeft: true });\r\n            return;\r\n\r\n          case ' ':\r\n            sendMessage({ ...response, isPressedFire: true });\r\n            break;\r\n\r\n          default:\r\n        }\r\n      }\r\n    },\r\n    [isOwnerLobby, isStateAppGame, sendMessage]\r\n  );\r\n\r\n  const handleKeyUp = useCallback(\r\n    (e) => {\r\n      if (isStateAppGame) {\r\n        e.preventDefault();\r\n        if (e.repeat) return;\r\n\r\n        const response = {\r\n          event: 'input',\r\n          isOwnerLobby,\r\n        };\r\n\r\n        switch (e.key) {\r\n          case 'ArrowRight':\r\n            sendMessage({ ...response, isReleasedRight: true });\r\n            return;\r\n\r\n          case 'ArrowLeft':\r\n            sendMessage({ ...response, isReleasedLeft: true });\r\n            break;\r\n\r\n          default:\r\n        }\r\n      }\r\n    },\r\n    [isOwnerLobby, isStateAppGame, sendMessage]\r\n  );\r\n\r\n  useEventListener('keydown', handleKeyDown);\r\n  useEventListener('keyup', handleKeyUp);\r\n};\r\n\r\nexport default useKeyEvents;\r\n","/* eslint-disable no-use-before-define */\r\nconst clearCanvas = (ctx) => {\r\n  ctx.setTransform(1, 0, 0, 1, 0, 0);\r\n  ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n};\r\n\r\nconst drawBullets = (ctx, stateGame) => {\r\n  const { owner, joiner } = stateGame;\r\n\r\n  for (let i = 0; i < owner.bullets.length; i += 1) {\r\n    ctx.fillStyle = owner.bullets[i].color;\r\n    ctx.fillRect(owner.bullets[i].x, owner.bullets[i].y, 4, 4);\r\n  }\r\n\r\n  for (let i = 0; i < joiner.bullets.length; i += 1) {\r\n    ctx.fillStyle = joiner.bullets[i].color;\r\n    ctx.fillRect(joiner.bullets[i].x, joiner.bullets[i].y, 4, 4);\r\n  }\r\n};\r\n\r\nconst drawJets = (ctx, stateGame, imagesJet) => {\r\n  const { owner, joiner } = stateGame;\r\n  const { imgJetOwner, imgJetJoiner } = imagesJet;\r\n\r\n  drawJet(ctx, owner, imgJetOwner);\r\n  drawJet(ctx, joiner, imgJetJoiner);\r\n};\r\n\r\nconst drawJet = (ctx, stateGamePlayer, imgJet) => {\r\n  const { scale, x, y } = stateGamePlayer;\r\n\r\n  // just works\r\n  const rad = -((stateGamePlayer.angle * Math.PI) / 180 + Math.PI);\r\n\r\n  // sets scale and origin\r\n  ctx.setTransform(scale, 0, 0, scale, x, y);\r\n  ctx.rotate(rad);\r\n  ctx.drawImage(imgJet, -imgJet.width / 2, -imgJet.height / 2);\r\n};\r\n\r\nexport { clearCanvas, drawBullets, drawJets };\r\n","// extracted by mini-css-extract-plugin\nexport default {\"game\":\"Game_game__8rvLL\"};","/* eslint-disable react/prop-types */\r\n/* eslint-disable no-use-before-define */\r\nimport { useRef, useEffect } from 'react';\r\n\r\n// utils\r\nimport { clearCanvas, drawBullets, drawJets } from '../utils/canvas';\r\n\r\n// config\r\nimport { typesJet } from '../../../config/typesJet';\r\n\r\n// styles\r\nimport styles from './Game.module.scss';\r\n\r\nconst draw = (ctx, stateGame, imagesJet) => {\r\n  clearCanvas(ctx);\r\n  drawBullets(ctx, stateGame);\r\n  drawJets(ctx, stateGame, imagesJet);\r\n};\r\n\r\nconst Game = ({ stateGame }) => {\r\n  console.log('Render: <Game />');\r\n  const refCanvas = useRef();\r\n  const imagesJet = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (!stateGame.settings.idLobby) return;\r\n\r\n    const imgJetOwner = new Image();\r\n    imgJetOwner.src = typesJet[stateGame.owner.typeJet].imgJet;\r\n\r\n    const imgJetJoiner = new Image();\r\n    imgJetJoiner.src = typesJet[stateGame.joiner.typeJet].imgJet;\r\n\r\n    imagesJet.current = {\r\n      imgJetOwner,\r\n      imgJetJoiner,\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!stateGame.settings.idLobby) return;\r\n\r\n    const canvas = refCanvas.current;\r\n    const context = canvas.getContext('2d');\r\n    let idRequestAnimationFrame;\r\n\r\n    const render = () => {\r\n      draw(context, stateGame, imagesJet.current);\r\n      idRequestAnimationFrame = requestAnimationFrame(render);\r\n    };\r\n    render();\r\n\r\n    return () => {\r\n      cancelAnimationFrame(idRequestAnimationFrame);\r\n    };\r\n  });\r\n\r\n  const { widthMap, heightMap } = stateGame.settings;\r\n\r\n  return (\r\n    <canvas\r\n      ref={refCanvas}\r\n      width={widthMap}\r\n      height={heightMap}\r\n      className={styles.game}\r\n    >\r\n      Game screen\r\n    </canvas>\r\n  );\r\n};\r\n\r\nexport default Game;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"header\":\"Header_header__ldbyd\"};","import PropTypes from 'prop-types';\r\n\r\n// styles\r\nimport styles from './Header.module.scss';\r\n\r\nconst Header = ({ text }) => <h2 className={styles.header}>{text}</h2>;\r\nHeader.propTypes = {\r\n  text: PropTypes.string,\r\n};\r\n\r\nexport default Header;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"wrapper\":\"Player_wrapper__n4edA\",\"name\":\"Player_name__8pYnT\",\"ball\":\"Player_ball__VKkU3\",\"jetType\":\"Player_jetType__MJuvK\",\"wrapperColor\":\"Player_wrapperColor__HId0W\",\"textColor\":\"Player_textColor__1K3tt\",\"squareColor\":\"Player_squareColor__o7tJg\"};","import PropTypes from 'prop-types';\r\n\r\n// styles\r\nimport styles from './Player.module.scss';\r\n\r\nconst Player = ({ player }) => {\r\n  const { name, score, typeJet } = player;\r\n\r\n  return (\r\n    <div className={styles.wrapper}>\r\n      <div className={styles.ball} />\r\n      <p className={styles.name}>\r\n        {name}: {score}\r\n      </p>\r\n      <p className={styles.jetType}>Jet type: {typeJet}</p>\r\n      <div className={styles.wrapperColor}>\r\n        <p className={styles.textColor}>Color:</p>\r\n        <div\r\n          style={{ backgroundColor: player.color }}\r\n          className={styles.squareColor}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nPlayer.propTypes = {\r\n  player: PropTypes.object,\r\n};\r\n\r\nexport default Player;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"table\":\"TablePlayers_table__MmT9u\"};","/* eslint-disable react/prop-types */\r\n\r\n// local components\r\nimport Header from './Header';\r\nimport Player from './Player';\r\n\r\n// styles\r\nimport styles from './TablePlayers.module.scss';\r\n\r\nconst TablePlayers = ({ stateGame }) => {\r\n  const { owner, joiner } = stateGame;\r\n  const { scoreMax } = stateGame.settings;\r\n\r\n  return (\r\n    <div className={styles.table}>\r\n      <Header text={`Max score: ${scoreMax}`} />\r\n      <Player player={owner} />\r\n      <Player player={joiner} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TablePlayers;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"wrapper\":\"Countdown_wrapper__b27ED\"};","import { useState, useEffect, useLayoutEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// styles\r\nimport styles from './Countdown.module.scss';\r\n\r\nconst Countdown = ({ handleCountownEnd }) => {\r\n  const [count, setCount] = useState(3);\r\n\r\n  useEffect(() => {\r\n    const idInterval = setInterval(() => {\r\n      setCount((prev) => prev - 1);\r\n    }, 1000);\r\n\r\n    return () => {\r\n      clearInterval(idInterval);\r\n    };\r\n  }, []);\r\n\r\n  useLayoutEffect(() => {\r\n    if (count < 1) handleCountownEnd();\r\n  });\r\n\r\n  return (\r\n    <div className={styles.wrapper}>\r\n      <div className={styles.count}>{count}</div>\r\n    </div>\r\n  );\r\n};\r\nCountdown.propTypes = {\r\n  handleCountownEnd: PropTypes.func,\r\n};\r\n\r\nexport default Countdown;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"wrapper\":\"GameOver_wrapper__c3ItD\"};","import { useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// styles\r\nimport styles from './GameOver.module.scss';\r\n\r\nconst GameOver = ({ winner, isOwnerLobby, handleGameOverEnd }) => {\r\n  console.log(winner, isOwnerLobby, handleGameOverEnd);\r\n  useEffect(() => {\r\n    const idInterval = setTimeout(() => {\r\n      handleGameOverEnd();\r\n    }, 3000);\r\n\r\n    return () => {\r\n      clearInterval(idInterval);\r\n      handleGameOverEnd();\r\n    };\r\n  }, [handleGameOverEnd]);\r\n\r\n  let text = winner === 'joiner' ? 'You Win' : 'You Lose';\r\n  if (isOwnerLobby) {\r\n    text = winner === 'owner' ? 'You Win' : 'You Lose';\r\n  }\r\n  if (winner === 'draw') {\r\n    text = `It's a draw`;\r\n  }\r\n\r\n  return <div className={styles.wrapper}>{text}</div>;\r\n};\r\nGameOver.propTypes = {\r\n  winner: PropTypes.string,\r\n  isOwnerLobby: PropTypes.bool,\r\n  handleGameOverEnd: PropTypes.func,\r\n};\r\n\r\nexport default GameOver;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"wrapper\":\"Overlay_wrapper__BWZYG\"};","import { useNavigate } from 'react-router-dom';\r\n\r\n// shared hooks\r\nimport { useContextGlobal } from '../../../providers/ProviderGlobal';\r\nimport { useContextLobby } from '../../../providers/ProviderLobby';\r\nimport { useContextWebsocket } from '../../../providers/ProviderWebsocket';\r\n\r\n// local components\r\nimport Countdown from './Countdown';\r\nimport GameOver from './GameOver';\r\n\r\n// styles\r\nimport styles from './Overlay.module.scss';\r\n\r\nconst Overlay = () => {\r\n  const [global, setGlobal] = useContextGlobal();\r\n  const [lobby] = useContextLobby();\r\n  const { sendMessage } = useContextWebsocket();\r\n  const navigate = useNavigate();\r\n\r\n  const { stateApp, isOwnerLobby, winner } = global;\r\n  const { idLobby } = lobby;\r\n\r\n  const isStateAppCountdown = stateApp === 'countdown';\r\n  const isStateAppGameOver = stateApp === 'gameOver';\r\n\r\n  const handleCountdownEnd = () => {\r\n    if (isOwnerLobby) {\r\n      sendMessage({ event: 'countdownEnd', idLobby });\r\n      setGlobal((prev) => ({ ...prev, stateApp: 'game' }));\r\n      return;\r\n    }\r\n\r\n    setGlobal((prev) => ({ ...prev, stateApp: 'game' }));\r\n  };\r\n\r\n  const handleGameOverEnd = () => {\r\n    setGlobal((prev) => ({ ...prev, stateApp: 'lobby' }));\r\n    navigate('/lobby');\r\n  };\r\n\r\n  return (\r\n    <div className={styles.wrapper}>\r\n      {isStateAppCountdown && (\r\n        <Countdown handleCountownEnd={handleCountdownEnd} />\r\n      )}\r\n      {isStateAppGameOver && (\r\n        <GameOver\r\n          winner={winner}\r\n          isOwnerLobby={isOwnerLobby}\r\n          handleGameOverEnd={handleGameOverEnd}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Overlay;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"pageGame\":\"PageGame_pageGame__4pe1X\"};","// shared hooks\r\nimport { useContextGlobal } from '../../providers/ProviderGlobal';\r\n\r\n// local hooks\r\nimport useGameWsEvents from './hooks/useGameWsEvents';\r\nimport useKeyEvents from './hooks/useKeyEvents';\r\n\r\n// shared components\r\nimport PageNonexistent from '../../components/PageNonexistent';\r\n\r\n// local components\r\nimport Game from './components/Game';\r\nimport TablePlayers from './components/TablePlayers';\r\nimport Overlay from './components/Overlay';\r\n\r\n// styles\r\nimport styles from './PageGame.module.scss';\r\n\r\nconst PageGame = () => {\r\n  const [dataGlobal] = useContextGlobal();\r\n  const stateGame = useGameWsEvents();\r\n  useKeyEvents();\r\n\r\n  const { stateApp } = dataGlobal;\r\n\r\n  if (!stateApp || stateApp === 'lobby' || stateApp === 'preLobby')\r\n    return <PageNonexistent />;\r\n\r\n  return (\r\n    <main className={styles.pageGame}>\r\n      <Game stateGame={stateGame} />\r\n      <TablePlayers stateGame={stateGame} />\r\n      <Overlay />\r\n    </main>\r\n  );\r\n};\r\n\r\nexport default PageGame;\r\n"],"names":["className","styles","to","stateGameDefault","joiner","name","score","owner","settings","scoreMax","widthMap","heightMap","stateGameInitial","useLocation","state","useContextGlobal","global","setGlobal","useContextLobby","lobby","setLobby","useContextWebsocket","message","resetMessage","navigate","useNavigate","stateApp","event","stateGameValid","stateGame","isStateAppCountdown","isStateAppGame","useEffect","console","log","prev","msgPopup","nameJoiner","isConnectedJoiner","isReadyJoiner","nameOwner","valueDefaultProviderLobby","winner","winsOwner","winsJoiner","isReadyOwner","eventName","handler","element","window","savedHandler","useRef","current","addEventListener","eventListener","removeEventListener","sendMessage","isOwnerLobby","handleKeyDown","useCallback","e","preventDefault","repeat","response","key","isPressedRight","isPressedLeft","isPressedFire","handleKeyUp","isReleasedRight","isReleasedLeft","useEventListener","drawJet","ctx","stateGamePlayer","imgJet","scale","x","y","rad","angle","Math","PI","setTransform","rotate","drawImage","width","height","draw","imagesJet","clearRect","canvas","clearCanvas","i","bullets","length","fillStyle","color","fillRect","drawBullets","imgJetOwner","imgJetJoiner","drawJets","refCanvas","idLobby","Image","src","typesJet","typeJet","idRequestAnimationFrame","context","getContext","render","requestAnimationFrame","cancelAnimationFrame","ref","text","player","style","backgroundColor","handleCountownEnd","useState","count","setCount","idInterval","setInterval","clearInterval","useLayoutEffect","handleGameOverEnd","setTimeout","isStateAppGameOver","dataGlobal","useGameWsEvents","useKeyEvents","PageNonexistent"],"sourceRoot":""}